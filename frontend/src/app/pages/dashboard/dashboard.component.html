<div class="row g-3">
  <!-- Filters -->
  <div class="col-12">
    <div class="card p-3">
      <div class="row g-2 align-items-end">
        <div class="col-6 col-md-3">
          <label class="form-label">Year</label>
          <select class="form-select" [(ngModel)]="year">
            <option *ngFor="let y of years()" [ngValue]="y">{{ y }}</option>
          </select>
        </div>
        <div class="col-6 col-md-3">
          <label class="form-label">Month</label>
          <select class="form-select" [(ngModel)]="month">
            <option *ngFor="let m of months()" [ngValue]="m">{{ pad(m) }}</option>
          </select>
        </div>
        <div class="col-12 col-md-3 d-grid">
          <button class="btn btn-primary" (click)="load()">
            <i class="bi bi-funnel me-1"></i> Apply
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Totals -->
  <div class="col-12 col-lg-4">
    <div class="card p-3 text-center">
      <div class="text-secondary small">Total Spend</div>
      <div class="display-6 text-danger">{{ totalSpend | number:'1.2-2' }}</div>
    </div>
  </div>
  <div class="col-12 col-lg-4">
    <div class="card p-3 text-center">
      <div class="text-secondary small">Total Income</div>
      <div class="display-6 text-success">{{ totalIncome | number:'1.2-2' }}</div>
    </div>
  </div>
  <div class="col-12 col-lg-4">
    <div class="card p-3 text-center">
      <div class="text-secondary small">Net (Income - Spend)</div>
      <div class="display-6" [ngClass]="{'text-success': net>=0, 'text-danger': net<0}">
        {{ net | number:'1.2-2' }}
      </div>
    </div>
  </div>

  <!-- By Category -->
  <div class="col-12 col-lg-6">
    <div class="card p-3">
      <h5 class="mb-3">Spend by Category</h5>
      <div class="table-responsive">
        <table class="table table-sm align-middle">
          <thead><tr><th>Category</th><th class="text-end">Total</th></tr></thead>
          <tbody>
            <tr *ngFor="let r of spendByCat">
              <td>{{ r.category }}</td>
              <td class="text-end">{{ r.total | number:'1.2-2' }}</td>
            </tr>
            <tr *ngIf="!spendByCat.length"><td colspan="2" class="text-center text-secondary py-3">No spend</td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <div class="col-12 col-lg-6">
    <div class="card p-3">
      <h5 class="mb-3">Income by Category</h5>
      <div class="table-responsive">
        <table class="table table-sm align-middle">
          <thead><tr><th>Category</th><th class="text-end">Total</th></tr></thead>
          <tbody>
            <tr *ngFor="let r of incomeByCat">
              <td>{{ r.category }}</td>
              <td class="text-end">{{ r.total | number:'1.2-2' }}</td>
            </tr>
            <tr *ngIf="!incomeByCat.length"><td colspan="2" class="text-center text-secondary py-3">No income</td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
